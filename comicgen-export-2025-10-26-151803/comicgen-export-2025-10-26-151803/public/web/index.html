<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>NovelToComic | å°è¯´è½¬æ¼«ç”»ç”Ÿæˆå¹³å°</title>
<style>
  :root{
    --primary:#0071e3; --primary-hover:#0077ED;
    --text:#1d1d1f; --muted:#86868b; --bg:#f5f5f7; --card:#fff;
    --ring:#d2d2d7;
    --shadow:0 4px 20px rgba(0,0,0,.05);
    --trans:all .25s ease;
  }
  *{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;}
  body{background:var(--bg);color:var(--text);line-height:1.55;overflow-x:hidden;}
  a{color:inherit;text-decoration:none}
  /* é¡¶éƒ¨å¯¼èˆªï¼ˆApple é£ï¼‰ */
  header{position:fixed;top:0;left:0;right:0;height:44px;padding:0 22px;display:flex;align-items:center;justify-content:space-between;background:rgba(255,255,255,.85);backdrop-filter:blur(20px);z-index:50}
  header .logo{font-weight:700;font-size:20px}
  header ul{display:flex;gap:18px;list-style:none;font-size:12px}
  header a:hover{color:var(--primary)}
  /* Hero */
  .hero{min-height:88vh;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:0 22px;background:linear-gradient(135deg,#f5f5f7 0%,#e8e8ed 100%)}
  .hero h1{font-size:80px;font-weight:800;letter-spacing:-.02em;background:linear-gradient(45deg,#1d1d1f,#424245);-webkit-text-fill-color:transparent;-webkit-background-clip:text}
  .hero p{margin-top:18px;color:var(--muted);font-size:26px;max-width:780px}
  .cta{margin-top:36px;display:inline-block;background:var(--primary);color:#fff;padding:12px 24px;border-radius:980px;font-weight:600;transition:var(--trans)}
  .cta:hover{background:var(--primary-hover);transform:translateY(-1px)}
  /* ç‰¹æ€§æ …æ ¼ï¼ˆä¿ç•™ï¼‰ */
  .section{padding:110px 22px;max-width:1200px;margin:0 auto}
  .title{font-size:48px;font-weight:800;text-align:center;margin-bottom:50px;letter-spacing:-.015em}
  .grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:28px}
  .card{background:var(--card);border-radius:18px;box-shadow:var(--shadow);padding:32px;text-align:center}
  .card .big{font-size:42px;margin-bottom:12px}
  .muted{color:var(--muted)}
  /* ç”Ÿæˆå™¨ï¼ˆå·¦å³å¸ƒå±€ï¼‰ */
  .generator{background:#fff;padding:90px 22px}
  .gen-wrap{max-width:1200px;margin:0 auto;display:grid;grid-template-columns:1.2fr .8fr;gap:28px}
  .panel{background:#fff;border:1px solid var(--ring);border-radius:16px;box-shadow:var(--shadow);padding:20px}
  .panel h3{font-size:18px;margin-bottom:14px;display:flex;align-items:center;gap:8px}
  .pill{font-size:12px;background:#eef4ff;color:#2455ff;padding:3px 8px;border-radius:999px}
  textarea.input{width:100%;min-height:220px;border:1px solid var(--ring);border-radius:12px;font-size:16px;padding:14px;resize:vertical;transition:var(--trans)}
  textarea.input:focus{outline:none;border-color:var(--primary)}
  .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
  .btn{background:var(--primary);color:#fff;border:none;padding:11px 18px;border-radius:999px;font-weight:600;cursor:pointer;transition:var(--trans)}
  .btn.secondary{background:#fff;color:var(--text);border:1px solid var(--ring)}
  .btn:hover{filter:brightness(1.03)}
  .chips{display:flex;gap:12px;flex-wrap:wrap;margin:14px 0}
  .chip{padding:9px 16px;border:1px solid var(--ring);border-radius:999px;cursor:pointer;transition:var(--trans);user-select:none}
  .chip.active{background:var(--primary);border-color:var(--primary);color:#fff}
  select, input[type="number"], input[type="text"]{
    border:1px solid var(--ring);border-radius:10px;padding:10px 12px;font-size:14px;outline:none;transition:var(--trans);width:100%;background:#fff;
  }
  select:focus, input:focus{border-color:var(--primary)}
  .kv{display:grid;grid-template-columns:140px 1fr;gap:12px;align-items:center;margin-bottom:12px}
  .progress{font-size:13px;color:var(--muted);margin-top:6px}
  .result-area{margin-top:22px}
  .grid-img{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px;margin-top:14px}
  .img-card{border:1px solid var(--ring);border-radius:12px;overflow:hidden;background:#fafafa}
  .img-card .ph{height:200px;display:flex;align-items:center;justify-content:center;color:#999;font-size:14px}
  .img-card img{width:100%;height:auto;display:block}
  pre.json{background:#0f172a;color:#e2e8f0;border-radius:12px;padding:12px;overflow:auto;max-height:240px;font-size:12px}

  /* ===== æ¢å¤åŸâ€œç”¨æˆ·æ•…äº‹ / æŠ€æœ¯äº®ç‚¹â€æ ·å¼ï¼ˆä¸åŸç‰ˆä¸€è‡´ï¼‰ ===== */
  .user-stories{padding:120px 22px;max-width:1200px;margin:0 auto;}
  .story-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:60px;}
  .story-card{background:#fff;border-radius:18px;padding:40px;box-shadow:var(--shadow);}
  .story-title{font-size:24px;font-weight:600;margin-bottom:20px;}
  .story-content{font-size:17px;color:var(--muted);}

  .tech-highlights{padding:120px 22px;background:#fff;}
  .tech-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:30px;max-width:1200px;margin:0 auto;}
  .tech-item{text-align:center;}
  .tech-icon{font-size:40px;margin-bottom:20px;}
  .tech-title{font-size:19px;font-weight:600;margin-bottom:10px;}
  .tech-description{font-size:14px;color:var(--muted);}

  @media(max-width:980px){ .gen-wrap{grid-template-columns:1fr} .hero h1{font-size:58px} .hero p{font-size:22px}}
  @media (max-width:768px){
    .story-grid{grid-template-columns:1fr;}
    .tech-grid{grid-template-columns:repeat(2,1fr);}
  }
</style>
</head>
<body>
  <!-- é¡¶éƒ¨ -->
  <header>
    <div class="logo">NovelToComic</div>
    <ul>
      <li><a href="#features">åŠŸèƒ½</a></li>
      <li><a href="#generator">ç”Ÿæˆå™¨</a></li>
      <li><a href="#stories">ç”¨æˆ·æ•…äº‹</a></li>
      <li><a href="#tech">æŠ€æœ¯äº®ç‚¹</a></li>
    </ul>
  </header>

  <!-- Hero -->
  <section class="hero">
    <h1>NovelToComic</h1>
    <p>å°†æ‚¨çš„å°è¯´æ–‡å­—ï¼Œç¬é—´è½¬åŒ–ä¸ºç²¾è‡´çš„æ¼«ç”»ç”»é¢ã€‚AI åˆ†é•œ + å¹¶å‘æ¸²æŸ“ï¼Œè¾¹ç”Ÿæˆè¾¹çœ‹æ•ˆæœã€‚</p>
    <a class="cta" href="#generator">å¼€å§‹åˆ›ä½œ</a>
  </section>

  <!-- åŠŸèƒ½æ¦‚è§ˆï¼ˆä¿ç•™ï¼‰ -->
  <section id="features" class="section">
    <h2 class="title">å¼ºå¤§åŠŸèƒ½</h2>
    <div class="grid-3">
      <div class="card"><div class="big">ğŸ“–</div><h3>æ™ºèƒ½åˆ†é•œ</h3><p class="muted">LLM è‡ªåŠ¨ä»å°è¯´ç‰‡æ®µæå–é•œå¤´ï¼Œè¾“å‡ºè§„èŒƒ JSONã€‚</p></div>
      <div class="card"><div class="big">âš¡</div><h3>å¹¶å‘æ¸²æŸ“</h3><p class="muted">å‰ç«¯æ§åˆ¶å¹¶å‘ï¼Œé€æ ¼ç”Ÿæˆï¼Œå¤±è´¥ä¸å½±å“æ•´ä½“ã€‚</p></div>
      <div class="card"><div class="big">ğŸ¨</div><h3>ç»Ÿä¸€ç”»é£</h3><p class="muted">ä¸€é”®è®¾å®šå…¨å±€ç”»é£å‰ç¼€ï¼Œä¿è¯é£æ ¼ä¸€è‡´ã€‚</p></div>
    </div>
  </section>

  <!-- ç”Ÿæˆå™¨ï¼ˆå·¦å³å¸ƒå±€ï¼›åŸåŠŸèƒ½ä¸å˜ï¼‰ -->
  <section id="generator" class="generator">
    <h2 class="title">æ¼«ç”»ç”Ÿæˆå™¨</h2>
    <div class="gen-wrap">
      <!-- å·¦åˆ—ï¼šå°è¯´ â†’ åˆ†é•œ -->
      <div class="panel">
        <h3>â‘  å°è¯´ â†’ åˆ†é•œ <span class="pill">LLM</span></h3>
        <div class="chips" id="styleChips">
          <div class="chip active">æ—¥å¼æ¼«ç”»</div>
          <div class="chip">ç¾å¼æ¼«ç”»</div>
          <div class="chip">é»‘ç™½çº¿ç¨¿</div>
          <div class="chip">æ°´å½©é£æ ¼</div>
          <div class="chip">å¤å¤æ°‘å›½æ°´ç²‰</div>
        </div>
        <textarea id="novel" class="input" placeholder="ç²˜è´´ä¸­æ–‡å°è¯´ç‰‡æ®µï¼Œå›è½¦æ¢è¡Œå‡å¯â€¦â€¦">é›¨å¤œä¸­ï¼Œå°‘å¹´è¿½é€å…‰å½±ï¼Œä»–çš„èº«å½±åœ¨æ¹¿æ¼‰æ¼‰çš„è¡—é“ä¸Šæ‹‰å¾—å¾ˆé•¿ã€‚è¿œå¤„çš„ç¯å…‰åœ¨é›¨ä¸­æ˜¾å¾—æœ¦èƒ§è€Œç¥ç§˜ï¼Œä»¿ä½›æŒ‡å¼•ç€ä»–å‰è¿›çš„æ–¹å‘ã€‚çªç„¶ï¼Œä¸€ä¸ªé»‘å½±ä»å··å£é—ªè¿‡ï¼Œå°‘å¹´åŠ å¿«äº†è„šæ­¥ã€‚</textarea>
        <div class="row" style="margin-top:10px">
          <button id="btnSb" class="btn">ç”Ÿæˆåˆ†é•œ JSON</button>
          <button id="btnClear" class="btn secondary">æ¸…ç©º</button>
        </div>
        <div style="margin-top:12px">
          <pre class="json" id="sbout" style="display:none"></pre>
        </div>
      </div>

      <!-- å³åˆ—ï¼šæ‰¹é‡æ¸²æŸ“æ§åˆ¶ï¼ˆå‰ç«¯å¹¶å‘ï¼‰ -->
      <div class="panel">
        <h3>â‘¡ æ‰¹é‡æ¸²æŸ“æ§åˆ¶ <span class="pill">å‰ç«¯å¹¶å‘</span></h3>

        <div class="kv">
          <div class="muted">å°ºå¯¸</div>
          <select id="size">
            <option value="1024x1024">1024x1024ï¼ˆæ­£æ–¹å½¢ï¼‰</option>
            <option value="1344x768">1344x768ï¼ˆæ¨ªç‰ˆ 16:9ï¼‰</option>
            <option value="768x1344">768x1344ï¼ˆç«–ç‰ˆ 9:16ï¼‰</option>
          </select>
        </div>

        <div class="kv">
          <div class="muted">å¹¶å‘æ•°</div>
          <input id="conc" type="number" min="1" max="6" value="3" />
        </div>

        <div class="kv">
          <div class="muted">ç»Ÿä¸€ç”»é£å‰ç¼€</div>
          <input id="prefix" type="text" placeholder="å¦‚ï¼šblack and white manga, line art, screentoneâ€¦" />
        </div>

        <div class="row" style="margin-top:8px">
          <button id="btnStart" class="btn">å¼€å§‹å¹¶å‘æ¸²æŸ“</button>
          <button id="btnStop" class="btn secondary">åœæ­¢é˜Ÿåˆ—</button>
          <button id="btnCopy" class="btn secondary">å¤åˆ¶å…¨éƒ¨é“¾æ¥</button>
        </div>
        <div class="progress" id="prog">è¿›åº¦ï¼š0/0</div>

        <div class="result-area">
          <div class="grid-img" id="grid"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- ====== ç”¨æˆ·æ•…äº‹ï¼ˆåŸæ ·æ¢å¤ï¼‰ ====== -->
  <section class="user-stories" id="stories">
      <h2 class="section title">ç”¨æˆ·æ•…äº‹</h2>
      <div class="story-grid">
          <div class="story-card">
              <h3 class="story-title">ç½‘ç»œå°è¯´ä½œè€…</h3>
              <p class="story-content">"ä½œä¸ºç½‘ç»œå°è¯´ä½œè€…ï¼Œæˆ‘ç»å¸¸éœ€è¦ä¸ºæˆ‘çš„ä½œå“é…å›¾ï¼Œä½†è¯·æ’ç”»å¸ˆæˆæœ¬å¤ªé«˜ã€‚ä½¿ç”¨NovelToComicåï¼Œæˆ‘å¯ä»¥å¿«é€Ÿå°†å…³é”®æƒ…èŠ‚è½¬åŒ–ä¸ºæ¼«ç”»åˆ†é•œï¼Œå¤§å¤§æå‡äº†è¯»è€…çš„é˜…è¯»ä½“éªŒã€‚"</p>
          </div>
          <div class="story-card">
              <h3 class="story-title">æ¼«ç”»çˆ±å¥½è€…</h3>
              <p class="story-content">"æˆ‘ä¸€ç›´æƒ³æŠŠè‡ªå·±å†™çš„å°æ•…äº‹å˜æˆæ¼«ç”»ï¼Œä½†ç»˜ç”»æŠ€èƒ½æœ‰é™ã€‚NovelToComicè®©æˆ‘æ¢¦æƒ³æˆçœŸï¼Œåªéœ€è¾“å…¥æ–‡å­—å°±èƒ½ç”Ÿæˆç²¾ç¾çš„æ¼«ç”»ï¼Œåˆ›ä½œé—¨æ§›å¤§å¤§é™ä½ã€‚"</p>
          </div>
      </div>
  </section>

  <!-- ====== æŠ€æœ¯äº®ç‚¹ï¼ˆåŸæ ·æ¢å¤ï¼‰ ====== -->
  <section class="tech-highlights" id="tech">
      <h2 class="section title">æŠ€æœ¯äº®ç‚¹</h2>
      <div class="tech-grid">
          <div class="tech-item">
              <div class="tech-icon">ğŸ§ </div>
              <h3 class="tech-title">å…ˆè¿›AIæ¨¡å‹</h3>
              <p class="tech-description">é‡‡ç”¨æœ€æ–°çš„AIGCæŠ€æœ¯ï¼Œç²¾å‡†ç†è§£æ–‡æœ¬è¯­ä¹‰</p>
          </div>
          <div class="tech-item">
              <div class="tech-icon">âš¡</div>
              <h3 class="tech-title">å¿«é€Ÿç”Ÿæˆ</h3>
              <p class="tech-description">äº‘ç«¯å¤„ç†ï¼Œåˆ†é’Ÿçº§ç”Ÿæˆå®Œæ•´æ¼«ç”»åˆ†é•œ</p>
          </div>
          <div class="tech-item">
              <div class="tech-icon">ğŸ­</div>
              <h3 class="tech-title">è§’è‰²ä¸€è‡´</h3>
              <p class="tech-description">ç‹¬ç‰¹ç®—æ³•ç¡®ä¿è§’è‰²åœ¨ä¸åŒåˆ†é•œä¸­ä¿æŒä¸€è‡´</p>
          </div>
          <div class="tech-item">
              <div class="tech-icon">ğŸ”„</div>
              <h3 class="tech-title">æŒç»­ä¼˜åŒ–</h3>
              <p class="tech-description">åŸºäºç”¨æˆ·åé¦ˆä¸æ–­æ”¹è¿›ç”Ÿæˆè´¨é‡</p>
          </div>
      </div>
  </section>

  <footer class="section" style="padding:40px 22px;text-align:center;color:#777">
    Â© 2025 NovelToComic
  </footer>

<script>
  // ===== æ¥å£ä¸å·¥å…·ï¼ˆçœŸå®è°ƒç”¨ /apiï¼Œå·²æ¥ä¸Šï¼‰ =====
  const API = '/api';
  const $  = s=>document.querySelector(s);
  const esc = s=>String(s??'').replace(/[&<>"]/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m]));
  async function postJSON(path, body){
    const r = await fetch(API+path,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});
    if(!r.ok) throw new Error(await r.text());
    return r.json();
  }
  function digPanels(sb){
    const list=[]; (sb.pages||[]).forEach(p=> (p.panels||[]).forEach(g=> list.push({id:g.id,desc:g.desc||''})));
    return list;
  }
  async function runPool(n, tasks){
    let i=0; const workers = Array.from({length:Math.min(n,tasks.length)}, ()=> (async ()=>{
      while(true){
        if(STOP) break;
        const cur=i++; if(cur>=tasks.length) break;
        try{ await tasks[cur](); }catch(_){}
      }
    })());
    await Promise.all(workers);
  }

  // ===== ç”»é£æ˜ å°„ï¼ˆå«â€œå¤å¤æ°‘å›½æ°´ç²‰â€ï¼‰ =====
  const STYLE_PREFIX = {
    'æ—¥å¼æ¼«ç”»':'anime style, clean line art, expressive characters, soft lighting',
    'ç¾å¼æ¼«ç”»':'american comic style, bold inking, halftone dots, dynamic angles',
    'é»‘ç™½çº¿ç¨¿':'black and white manga, line art, screentone, high contrast, dramatic lighting',
    'æ°´å½©é£æ ¼':'watercolor painting, soft pastel colors, light granulation, dreamy atmosphere',
    'å¤å¤æ°‘å›½æ°´ç²‰':'Republic of China era watercolor & gouache illustration, 1930s Shanghai street life, warm sepia tone, retro poster texture, nostalgic detail'
  };

  // ===== çŠ¶æ€ =====
  let LAST_SB = null;          // æœ€è¿‘ä¸€æ¬¡åˆ†é•œ JSONï¼ˆå¯¹è±¡ï¼‰
  let STOP = false;            // åœæ­¢å¹¶å‘å¼€å…³
  let LINKS = [];              // æœ¬è½®ç”Ÿæˆå›¾ç‰‡é“¾æ¥

  // ===== é£æ ¼ chips äº¤äº’ =====
  const chips = Array.from(document.querySelectorAll('#styleChips .chip'));
  function activeStyle(){
    const a = chips.find(c=>c.classList.contains('active'));
    return a ? a.textContent.trim() : 'é»‘ç™½çº¿ç¨¿';
  }
  function syncPrefixByStyle(){
    const name = activeStyle();
    const preset = STYLE_PREFIX[name] || STYLE_PREFIX['é»‘ç™½çº¿ç¨¿'];
    const cur = ($('#prefix').value||'').trim();
    if(!cur) $('#prefix').value = preset;
  }
  chips.forEach(el=>{
    el.addEventListener('click', ()=>{
      chips.forEach(x=>x.classList.remove('active'));
      el.classList.add('active');
      syncPrefixByStyle();
    });
  });
  // åˆå§‹åŒæ­¥
  syncPrefixByStyle();

  // ===== æŒ‰é’®ï¼šæ¸…ç©º =====
  $('#btnClear').addEventListener('click', ()=>{
    $('#novel').value = '';
    $('#sbout').style.display='none';
    $('#sbout').textContent='';
    $('#grid').innerHTML='';
    $('#prog').textContent='è¿›åº¦ï¼š0/0';
    LINKS.length = 0;
    LAST_SB = null;
  });

  // ===== æŒ‰é’®ï¼šç”Ÿæˆåˆ†é•œ JSONï¼ˆçœŸå® /api/storyboardï¼‰ =====
  $('#btnSb').addEventListener('click', async ()=>{
    const text = $('#novel').value.trim();
    if(!text){ alert('è¯·è¾“å…¥å°è¯´å†…å®¹'); return; }
    const styleName = activeStyle();

    const btn = $('#btnSb'); const old = btn.textContent;
    btn.textContent='ç”Ÿæˆä¸­â€¦'; btn.disabled = true;
    try{
      const res = await postJSON('/storyboard', { text, style: styleName });
      const sb = JSON.parse(res.storyboard_json||'{}');
      LAST_SB = sb;
      $('#sbout').style.display='block';
      $('#sbout').textContent = JSON.stringify(sb, null, 2);
    }catch(e){ alert('ç”Ÿæˆåˆ†é•œå¤±è´¥ï¼š'+(e.message||e)); }
    finally{ btn.textContent=old; btn.disabled=false; }
  });

  // ===== å¹¶å‘æ¸²æŸ“ï¼ˆçœŸå® /api/imageï¼‰ =====
  $('#btnStart').addEventListener('click', async ()=>{
    STOP = false; LINKS.length=0;
    const size = $('#size').value;
    const conc = Math.max(1, Math.min(6, parseInt($('#conc').value||'3',10)));
    const prefix = ($('#prefix').value||'').trim() || STYLE_PREFIX['é»‘ç™½çº¿ç¨¿'];

    // è‹¥æ— åˆ†é•œï¼Œè‡ªåŠ¨å…ˆè°ƒä¸€æ¬¡ /storyboard
    if(!LAST_SB){
      const text = $('#novel').value.trim();
      if(!text){ alert('è¯·å…ˆè¾“å…¥å°è¯´æ–‡æœ¬æˆ–ç‚¹å‡»"ç”Ÿæˆåˆ†é•œ JSON"'); return; }
      try{
        const res = await postJSON('/storyboard', { text, style: activeStyle() });
        LAST_SB = JSON.parse(res.storyboard_json||'{}');
        $('#sbout').style.display='block';
        $('#sbout').textContent = JSON.stringify(LAST_SB, null, 2);
      }catch(e){ alert('ç”Ÿæˆåˆ†é•œå¤±è´¥ï¼š'+(e.message||e)); return; }
    }

    const panels = digPanels(LAST_SB);
    if(!panels.length){ alert('åˆ†é•œä¸ºç©ºï¼Œè¯·æ£€æŸ¥æ–‡æœ¬æˆ–é‡è¯•'); return; }

    // å ä½
    const grid = $('#grid'); grid.innerHTML='';
    panels.forEach((p,idx)=>{
      const card = document.createElement('div');
      card.className = 'img-card';
      card.innerHTML = `
        <div class="ph" id="ph-${idx}">ç”Ÿæˆä¸­â€¦</div>
        <div style="padding:10px;font-size:12px;color:#666">#${esc(p.id??(idx+1))}ï¼š${esc(p.desc)}</div>
      `;
      grid.appendChild(card);
    });
    $('#prog').textContent = `è¿›åº¦ï¼š0/${panels.length}`;

    // ä»»åŠ¡æ± 
    let done = 0;
    const tasks = panels.map((p,idx)=> async ()=>{
      const prompt = `${prefix} ${p.desc}`.trim();
      try{
        const r = await postJSON('/image', { prompt, size });
        LINKS.push(r.url);
        const box = document.getElementById(`ph-${idx}`);
        if(box){
          box.outerHTML = `<img loading="lazy" src="${r.url}" alt="panel-${idx}"/>`;
        }
      }catch(e){
        const box = document.getElementById(`ph-${idx}`);
        if(box){ box.textContent = 'å¤±è´¥'; box.style.color = '#e11d48'; }
      }finally{
        done++; $('#prog').textContent = `è¿›åº¦ï¼š${done}/${panels.length}`;
      }
    });

    try{ await runPool(conc, tasks); }catch(_){}
  });

  // åœæ­¢é˜Ÿåˆ—
  $('#btnStop').addEventListener('click', ()=>{ STOP = true; });

  // å¤åˆ¶å…¨éƒ¨é“¾æ¥
  $('#btnCopy').addEventListener('click', async ()=>{
    if(!LINKS.length){ alert('æ— å¯å¤åˆ¶çš„é“¾æ¥'); return; }
    try{
      await navigator.clipboard.writeText(LINKS.join('\n'));
      alert('å·²å¤åˆ¶å…¨éƒ¨å›¾ç‰‡é“¾æ¥');
    }catch(_){
      const ta = document.createElement('textarea');
      ta.value = LINKS.join('\n'); document.body.appendChild(ta);
      ta.select(); document.execCommand('copy'); ta.remove();
      alert('å·²å¤åˆ¶å…¨éƒ¨å›¾ç‰‡é“¾æ¥');
    }
  });

  // å¦‚æœä»¥ #generator æ‰“å¼€ï¼Œæ»šåˆ°ç”Ÿæˆå™¨
  if(location.hash==='#generator'){ document.getElementById('generator').scrollIntoView(); }
</script>
</body>
</html>
